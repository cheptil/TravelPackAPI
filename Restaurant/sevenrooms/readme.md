# Исследование SevenRooms API и интеграций

## Обзор платформы SevenRooms

SevenRooms - это платформа для управления ресторанами, которая предлагает более 100 интеграций и гибкий API для объединения технологического стека ресторана.

### Основные возможности:
- Унификация технологического стека ресторана
- Упрощение операций и улучшение опыта гостей
- Повышение прибыльности

### Категории интеграций:

#### 1. Каналы бронирования (Booking channels)
- **Google**: Предложение бронирования в реальном времени и доступности листа ожидания через Google Search, Maps и Assistant глобально
- **Facebook**: Получение прямых бронирований со страниц ресторана в Facebook
- **Instagram**: Демонстрация бронирований для прямого бронирования в бизнес-профилях ресторана в Instagram
- **TheFork**: Продвижение открытий на ведущей онлайн-платформе бронирования ресторанов с почти 80,000 партнерских ресторанов по всему миру

#### 2. Платформы обнаружения и бронирования
- **Ten Lifestyles Group**: Сервис консьержа для помощи участникам в обнаружении и организации путешествий, ужинов и развлечений
- **Tripadvisor**: Получение бронирований через крупнейшую в мире платформу путешествий
- **Reserveout**: Размещение бронирований на топовой платформе обнаружения и бронирования ресторанов на Ближнем Востоке
- **eat**: Предложение бронирований на eat, платформе обнаружения и бронирования ресторанов на Ближнем Востоке

#### 3. Специализированные платформы
- **Afternoon Tea.co.uk**: Обнаружение в премиум-гиде по Великобритании для поиска и бронирования идеального опыта послеобеденного чая
- **Bruncher.com**: Появление в гиде для поиска и бронирования завтраков, бранчей и воскресных обедов в Великобритании
- **Aspire Lifestyles**: Партнерство с глобальным консьержем, предлагающим бронирования ресторанов и кураторские опыты
- **Wddk**: Передовая саудовская технологическая платформа для улучшения бронирований ресторанов в Саудовской Аравии

#### 4. Азиатские платформы
- **OpenRice**: Повышение обнаруживаемости на пользовательской платформе обзоров ресторанов в Азии с бронированием, платежами и инструментами лояльности
- **Chope**: Расширение присутствия с платформой обнаружения, бронирования, доставки и лояльности ресторанов в семи азиатских городах
- **InKind Capital**: Рост бизнеса с инструментом, который предоставляет операторам самую низкую стоимость капитала и привлекает новых, лояльных, высокооплачиваемых гостей

### POS интеграции

SevenRooms предлагает мощные интеграции с POS системами для получения максимальной отдачи от данных гостей:

- **MICROS Simphony**: Управление продажами с POS системой для ресторанов, отелей, курортов, казино и других заведений
- **Square for Restaurants**: Универсальное POS программное обеспечение для эффективного управления рестораном
- **Lightspeed**: Мощная, но простая, универсальная, облачная POS система для обработки доходов
- **InfoGenesis POS**: Повышение эффективности еды и напитков и обслуживания гостей с отмеченной наградами бесконтактной POS

## Следующие шаги исследования

1. Поиск документации API SevenRooms
2. Поиск доступных API в Manus API Hub
3. Выполнение тестового запроса
4. Анализ результатов



## Информация об API SevenRooms

### Найденная документация:

1. **GitHub репозиторий tap-sevenrooms**: https://github.com/uptilab2/tap-sevenrooms
   - Содержит Singer tap для извлечения данных из SevenRooms Reservations API
   - Извлекает ресурс: Reservations
   - Поддерживает инкрементальное извлечение данных

### Параметры конфигурации API:

```json
{
  "base_url": "https://demo.sevenrooms.com/api-ext/2_2",
  "client_id": "my_username",
  "client_secret": "my_password", 
  "venue_group_id": "venue_gid",
  "start_date": "2017-01-01T00:00:00Z"
}
```

### Требования для аутентификации:
- **Client ID**: Идентификатор клиента
- **Client Secret**: Секретный ключ клиента
- **Venue Group ID**: Идентификатор группы заведений
- **Base URL**: Базовый URL API (demo: https://demo.sevenrooms.com/api-ext/2_2)

### Доступные ресурсы:
- **Reservations**: Данные о бронированиях ресторанов

### Метод аутентификации:
- API логин выполняется через ID и SECRET, если токен API не найден
- Поддерживается OAuth-подобная аутентификация



## Результаты тестирования API SevenRooms

### Выполненные тесты

Было проведено комплексное тестирование API SevenRooms с использованием demo URL: `https://demo.sevenrooms.com/api-ext/2_2`

#### 1. Тест доступности базового URL

**Результат**: API отвечает, но возвращает ошибку 404
```json
{
  "status": 404,
  "msg": "Could not find resource"
}
```

**Анализ**: Базовый URL недоступен, что указывает на необходимость использования конкретных эндпоинтов.

#### 2. Тестирование аутентификации

Протестированы различные методы аутентификации:

1. **POST /auth с JSON**: Статус 400 - "Missing arg client_id"
2. **POST /login с JSON**: Статус 404 - "Could not find resource"  
3. **POST /token с form data**: Статус 404 - "Could not find resource"

**Анализ**: API ожидает параметры аутентификации, но эндпоинт `/auth` существует и требует правильные client_id и client_secret.

#### 3. Тестирование доступных отчетов

Согласно документации Kleene.ai, доступны следующие отчеты:

| Отчет | Статус тестирования | Результат |
|-------|-------------------|-----------|
| venues | ✅ Эндпоинт найден | 401 - Missing Authentication |
| reservations | ✅ Эндпоинт найден | 401 - Missing Authentication |
| clients | ✅ Эндпоинт найден | 401 - Missing Authentication |
| reservation_requests | ❌ Эндпоинт не найден | 404 - Could not find resource |
| events | ❌ Эндпоинт не найден | 404 - Could not find resource |
| programs | ❌ Эндпоинт не найден | 404 - Could not find resource |
| charges | ❌ Эндпоинт не найден | 404 - Could not find resource |
| reservation_feedback | ❌ Эндпоинт не найден | 404 - Could not find resource |
| payout_profiles | ❌ Эндпоинт не найден | 404 - Could not find resource |

### Структура ошибок API

API SevenRooms использует стандартизированную структуру ошибок:

```json
{
  "code": 401,
  "status": 401,
  "msg": "Missing Authentication parameters",
  "request_id": "уникальный_идентификатор_запроса"
}
```

**Ключевые поля**:
- `code` и `status`: HTTP статус код
- `msg`: Человекочитаемое описание ошибки
- `request_id`: Уникальный идентификатор для отслеживания запроса

### Анализ требований к аутентификации

На основе тестирования выявлены следующие требования:

1. **Обязательные параметры**:
   - `client_id`: Идентификатор клиента
   - `client_secret`: Секретный ключ клиента
   - `venue_group_id`: Идентификатор группы заведений

2. **Необходимые разрешения**:
   - Access to search/export payment charges
   - Access to search/export clients

3. **Формат данных**: JSON для запросов и ответов

4. **CORS поддержка**: API поддерживает кросс-доменные запросы

### Доступные эндпоинты

Подтверждено существование следующих эндпоинтов:

- `GET /venues` - Информация о заведениях
- `GET /reservations` - Данные о бронированиях  
- `GET /clients` - Информация о клиентах
- `POST /auth` - Аутентификация

### Технические характеристики API

1. **Версия API**: 2_2 (указана в URL)
2. **Протокол**: HTTPS
3. **Формат данных**: JSON
4. **Кодировка**: UTF-8
5. **Сервер**: Google Frontend (согласно заголовкам)
6. **Безопасность**: HTTPS с HSTS

### Ограничения demo-версии

Demo API имеет следующие ограничения:

1. Не все эндпоинты доступны
2. Требуются реальные учетные данные для полного доступа
3. Некоторые отчеты могут быть недоступны в demo-режиме

## Рекомендации для работы с API SevenRooms

### Для разработчиков

1. **Получение доступа**:
   - Обратитесь к представителю SevenRooms для получения реальных client_id и client_secret
   - Убедитесь в наличии необходимых разрешений для вашего аккаунта

2. **Настройка аутентификации**:
   ```python
   auth_data = {
       "client_id": "ваш_client_id",
       "client_secret": "ваш_client_secret"
   }
   response = requests.post("https://api.sevenrooms.com/api-ext/2_2/auth", json=auth_data)
   ```

3. **Работа с данными**:
   - Используйте инкрементальную загрузку для отчетов Clients и Reservations
   - Для отчета Programs ограничивайте период до одного года
   - Обрабатывайте ошибки на основе структуры JSON ответов

4. **Мониторинг**:
   - Используйте request_id для отслеживания проблемных запросов
   - Реализуйте retry логику для временных ошибок

### Для интеграции

1. **Основные эндпоинты для интеграции**:
   - `/venues` - Получение списка заведений
   - `/reservations` - Работа с бронированиями
   - `/clients` - Управление клиентской базой

2. **Параметры запросов**:
   - Всегда включайте `venue_group_id`
   - Используйте фильтры по датам для оптимизации
   - Реализуйте пагинацию для больших объемов данных

3. **Обработка ошибок**:
   - 401: Проверьте параметры аутентификации
   - 404: Убедитесь в правильности URL эндпоинта
   - 400: Проверьте обязательные параметры запроса

## Заключение

API SevenRooms представляет собой современный REST API с JSON форматом данных, требующий OAuth-подобной аутентификации. Для полноценной работы необходимы реальные учетные данные от SevenRooms. Demo-версия позволяет протестировать структуру API и понять требования к аутентификации, но ограничена в функциональности.

Основные преимущества API:
- Стандартизированная структура ошибок
- Поддержка CORS
- Инкрементальная загрузка данных
- Широкий набор отчетов для ресторанного бизнеса

Для production использования рекомендуется:
1. Получить реальные учетные данные
2. Изучить официальную документацию API
3. Реализовать надежную обработку ошибок
4. Использовать инкрементальную синхронизацию данных

