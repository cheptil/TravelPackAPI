# Анализ Foursquare Developer API

## Обзор
Foursquare предоставляет геопространственные API и SDK для создания location-aware приложений. При регистрации предоставляется $200 в кредитах.

## Основные API

### 1. Places API
- Доступ к глобальным POI данным от 100k+ доверенных источников
- Поиск, обнаружение и ранжирование мест в реальном времени

### 2. Search & Data
- Возвращает места на основе пользовательских ключевых слов
- Сопоставление по названиям, категориям, советам и вкусам

### 3. Geotagging & Check-in
- Предоставляет POI теги, поддерживающие check-in
- Основано на местоположении устройства пользователя и окружении

### 4. Autocomplete
- Возвращает список топ адресов, мест, геолокаций
- Частичное совпадение по предоставленному ключевому слову и местоположению

## Следующие шаги
1. Изучить документацию Places API
2. Получить API ключи
3. Выполнить тестовый запрос



## Детали Places API

### Основная информация
- База данных: 100 миллионов мест в более чем 1500 категориях
- Источники: 100K+ доверенных источников
- Возможности: поиск, обнаружение и ранжирование мест в реальном времени

### Основные API endpoints

#### 1. Search & Data
- Возвращает места на основе пользовательских ключевых слов
- Сопоставление по названиям, категориям, советам и вкусам

#### 2. Geotagging & Check-in  
- Определяет местоположение устройства пользователя
- Предоставляет POI теги для check-in функциональности

#### 3. Autocomplete
- Возвращает список топ адресов, мест, геолокаций
- Частичное совпадение по ключевому слову и местоположению

#### 4. Address Data
- Получение деталей для любого адреса, включая не-Places
- Работает только в связке с Autocomplete endpoint

#### 5. Places Feedback
- Позволяет пользователям предоставлять обратную связь о POI

### Процесс начала работы
1. Войти в Foursquare Developer Account
2. Создать новый проект
3. Сгенерировать API ключ
4. Создать и протестировать первый API вызов

### Пример API вызова
- URL: https://api.foursquare.com/v3/places/search
- Метод: Place Search
- Требуется: API ключ для аутентификации
- Параметры: location, query, категории и др.

### Инструменты
- Foursquare API Explorer - для тестирования API вызовов
- Developer Console - для управления ключами и биллингом


## Тестирование API

### Попытка выполнения запроса
Из-за ограничений sandbox среды не удалось выполнить прямые HTTP запросы к API. Однако, на основе изученной документации и интерактивного API Explorer можно сделать следующие выводы:

### Требования для работы с API
1. **Обязательная авторизация**: Все запросы к Foursquare Places API требуют API ключ
2. **Регистрация**: Необходимо создать аккаунт разработчика на https://foursquare.com/developer/
3. **Создание проекта**: В Developer Console нужно создать новый проект
4. **Генерация API ключа**: Получить API ключ для авторизации запросов

### Структура API запроса

#### Базовый URL
```
https://api.foursquare.com/v3/places/search
```

#### Обязательные заголовки
```
Accept: application/json
Authorization: YOUR_API_KEY
```

#### Основные параметры
- `query` (string) - поисковый запрос (например, "coffee")
- `ll` (string) - координаты в формате "latitude,longitude" 
- `radius` (int) - радиус поиска в метрах (максимум 100,000)
- `limit` (int) - количество результатов (по умолчанию 50)
- `categories` (string) - фильтр по категориям
- `chains` (string) - фильтр по сетевым заведениям

#### Пример запроса
```bash
curl --request GET \
  --url 'https://api.foursquare.com/v3/places/search?query=coffee&ll=55.7558,37.6176&radius=1000&limit=5' \
  --header 'Accept: application/json' \
  --header 'Authorization: YOUR_API_KEY'
```

### Структура ответа API

На основе примера из документации, API возвращает JSON со следующей структурой:

```json
{
  "results": [
    {
      "fsq_id": "string",
      "categories": [
        {
          "id": 0,
          "name": "string",
          "short_name": "string",
          "plural_name": "string",
          "icon": {
            "id": "string",
            "created_at": "2025-06-14T16:46:45.731Z",
            "prefix": "string",
            "suffix": "string",
            "width": 0,
            "height": 0,
            "classifications": ["string"]
          }
        }
      ],
      "chains": [
        {
          "id": "string",
          "name": "string"
        }
      ],
      "distance": 0,
      "geocodes": {
        "drop_off": {
          "latitude": 0,
          "longitude": 0
        },
        "front_door": {
          "latitude": 0,
          "longitude": 0
        },
        "main": {
          "latitude": 0,
          "longitude": 0
        },
        "road": {
          "latitude": 0,
          "longitude": 0
        },
        "roof": {
          "latitude": 0,
          "longitude": 0
        }
      },
      "link": "string",
      "location": {
        "address": "string",
        "address_extended": "string",
        "admin_region": "string",
        "census_block": "string",
        "country": "string",
        "cross_street": "string",
        "dma": "string",
        "formatted_address": "string",
        "locality": "string",
        "neighborhood": ["string"],
        "po_box": "string",
        "post_town": "string",
        "postcode": "string",
        "region": "string"
      },
      "name": "string",
      "related_places": {},
      "timezone": "string"
    }
  ]
}
```

### Ключевые поля ответа

#### Основная информация о месте
- `fsq_id` - уникальный идентификатор места в Foursquare
- `name` - название заведения
- `distance` - расстояние от указанной точки поиска

#### Категоризация
- `categories` - массив категорий с подробной информацией
- `chains` - информация о сетевых заведениях

#### Геолокация
- `geocodes` - различные типы координат (главный вход, крыша, дорога и т.д.)
- `location` - подробная адресная информация

#### Дополнительная информация
- `timezone` - часовой пояс
- `link` - ссылка на страницу места
- `related_places` - связанные места


## Практические примеры использования

### 1. Поиск кофеен в Москве
```python
import requests

url = "https://api.foursquare.com/v3/places/search"
headers = {
    "Accept": "application/json",
    "Authorization": "YOUR_API_KEY"
}
params = {
    "query": "coffee",
    "ll": "55.7558,37.6176",  # Красная площадь, Москва
    "radius": 2000,
    "limit": 10
}

response = requests.get(url, headers=headers, params=params)
data = response.json()

for place in data["results"]:
    print(f"Название: {place['name']}")
    print(f"Адрес: {place['location']['formatted_address']}")
    print(f"Расстояние: {place['distance']} метров")
    print("---")
```

### 2. Поиск ресторанов определенной категории
```python
params = {
    "categories": "13065",  # ID категории "Restaurant"
    "ll": "55.7558,37.6176",
    "radius": 1500,
    "limit": 15
}
```

### 3. Исключение сетевых заведений
```python
params = {
    "query": "pizza",
    "ll": "55.7558,37.6176",
    "exclude_all_chains": True,  # Исключить все сетевые заведения
    "limit": 10
}
```

## Дополнительные API endpoints

### 1. Get Place Details
- **URL**: `https://api.foursquare.com/v3/places/{fsq_id}`
- **Назначение**: Получение подробной информации о конкретном месте
- **Параметры**: `fields` - список полей для возврата

### 2. Get Place Photos
- **URL**: `https://api.foursquare.com/v3/places/{fsq_id}/photos`
- **Назначение**: Получение фотографий места
- **Параметры**: `limit`, `sort`

### 3. Get Place Tips
- **URL**: `https://api.foursquare.com/v3/places/{fsq_id}/tips`
- **Назначение**: Получение отзывов и советов о месте
- **Параметры**: `limit`, `sort`

### 4. Autocomplete
- **URL**: `https://api.foursquare.com/v3/autocomplete`
- **Назначение**: Автодополнение для поиска мест
- **Параметры**: `text`, `ll`, `radius`

### 5. Geotagging (Nearby)
- **URL**: `https://api.foursquare.com/v3/places/nearby`
- **Назначение**: Поиск ближайших мест для check-in
- **Параметры**: `ll`, `radius`, `limit`

## Ограничения и квоты

### Бесплатный план
- **Запросы**: Ограниченное количество запросов в день
- **Кредиты**: $200 при регистрации
- **Функциональность**: Доступ ко всем основным API

### Коммерческое использование
- **Платные планы**: Для высоконагруженных приложений
- **Расширенные квоты**: Больше запросов в секунду/день
- **Поддержка**: Приоритетная техническая поддержка

## Рекомендации по использованию

### 1. Оптимизация запросов
- Используйте параметр `limit` для ограничения количества результатов
- Применяйте фильтры `categories` и `chains` для более точного поиска
- Кэшируйте результаты для часто запрашиваемых локаций

### 2. Обработка ошибок
```python
try:
    response = requests.get(url, headers=headers, params=params)
    response.raise_for_status()  # Вызовет исключение для HTTP ошибок
    data = response.json()
except requests.exceptions.HTTPError as e:
    if response.status_code == 401:
        print("Ошибка авторизации: проверьте API ключ")
    elif response.status_code == 429:
        print("Превышен лимит запросов")
    else:
        print(f"HTTP ошибка: {e}")
except requests.exceptions.RequestException as e:
    print(f"Ошибка запроса: {e}")
```

### 3. Безопасность
- Никогда не включайте API ключи в клиентский код
- Используйте переменные окружения для хранения ключей
- Ограничивайте домены в настройках API ключа

### 4. Производительность
- Используйте асинхронные запросы для множественных вызовов
- Реализуйте retry логику с экспоненциальной задержкой
- Мониторьте использование квот

## Заключение

Foursquare Places API предоставляет мощный инструмент для работы с геопространственными данными и информацией о местах. API отличается:

### Преимущества
- **Обширная база данных**: 100+ миллионов мест по всему миру
- **Высокое качество данных**: Проверенная информация от множества источников
- **Богатая функциональность**: Поиск, детали, фото, отзывы, автодополнение
- **Хорошая документация**: Подробные примеры и интерактивный API Explorer
- **Гибкие фильтры**: Категории, сети, радиус поиска

### Ограничения
- **Обязательная авторизация**: Требуется API ключ для всех запросов
- **Квоты**: Ограничения на количество запросов
- **Стоимость**: Платные планы для коммерческого использования

### Рекомендации к использованию
API подходит для:
- Мобильных приложений с функциями поиска мест
- Веб-сервисов геолокации
- Аналитических систем для бизнеса
- Приложений для путешествий и туризма
- Систем рекомендаций мест

Для начала работы рекомендуется зарегистрироваться на платформе разработчика, получить API ключ и протестировать основные функции через API Explorer.

