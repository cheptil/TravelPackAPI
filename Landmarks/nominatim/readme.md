# Изучение Nominatim API

## Обзор API

Nominatim - это веб-сервис для геокодирования, который предоставляет API версии 1 со следующими основными эндпоинтами:

- **/search** - поиск OSM объектов по названию или типу
- **/reverse** - поиск OSM объектов по их местоположению  
- **/lookup** - поиск деталей адреса для OSM объектов по их ID
- **/status** - запрос статуса сервера
- **/details** - показ внутренних деталей объекта (только для отладки)

## Эндпоинт /search

### Базовый URL
```
https://nominatim.openstreetmap.org/search?<params>
```

### Типы запросов

1. **Free-form query** - неструктурированный запрос
   - Параметр: `q` - строка для поиска
   - Пример: "pilkington avenue, birmingham"

2. **Structured query** - структурированный запрос
   - Параметры: amenity, street, city, county, state, country, postalcode
   - Каждый параметр опционален

### Основные параметры

- `format` - формат вывода (json, xml, geojson и др.)
- `limit` - максимальное количество результатов (не более 40)
- `addressdetails` - включить разбивку адреса на элементы (1/0)
- `extratags` - включить дополнительную информацию (1/0)
- `namedetails` - включить полный список названий (1/0)
- `accept-language` - предпочитаемый язык результатов
- `countrycodes` - фильтр по кодам стран (ISO 3166-1alpha2)

### Пример запроса из документации
```
https://nominatim.openstreetmap.org/search?q=135+pilkington+avenue,+birmingham&format=xml&polygon_kml=1&addressdetails=1
```

## Следующие шаги
1. Выполнить тестовый запрос к API
2. Проанализировать структуру ответа
3. Документировать результаты



## Результаты тестирования API

### Выполненные запросы

#### 1. Free-form запрос
**Запрос:** "Красная площадь, Москва"
**Параметры:**
- format: json
- addressdetails: 1
- limit: 5
- extratags: 1
- namedetails: 1
- accept-language: ru,en

**Результат:** Успешно найден 1 результат

#### 2. Структурированный запрос
**Параметры:**
- city: Moscow
- country: Russia
- format: json
- addressdetails: 1
- limit: 3

**Результат:** Успешно найден 1 результат (город Москва)

### Важные требования API

1. **User-Agent заголовок обязателен** - без него API возвращает ошибку 403
2. **Соблюдение политики использования** - необходимо указывать идентификацию приложения
3. **Ограничения на частоту запросов** - рекомендуется делать паузы между запросами

### Структура ответа API

Каждый результат поиска содержит следующие основные поля:

#### Основная информация
- `place_id` - уникальный идентификатор места в Nominatim
- `osm_type` - тип OSM объекта (node, way, relation)
- `osm_id` - идентификатор объекта в OpenStreetMap
- `lat`, `lon` - координаты (широта, долгота)
- `class`, `type` - классификация объекта
- `place_rank` - ранг места (влияет на приоритет в результатах)
- `importance` - важность объекта (число от 0 до 1)

#### Адресная информация
- `display_name` - полное отображаемое название
- `address` - структурированный адрес с компонентами:
  - `road` - название дороги/улицы
  - `quarter` - квартал
  - `neighbourhood` - район
  - `suburb` - пригород
  - `city` - город
  - `state` - штат/область
  - `region` - регион
  - `postcode` - почтовый индекс
  - `country` - страна
  - `country_code` - код страны

#### Дополнительная информация
- `extratags` - дополнительные OSM теги:
  - `wikidata` - идентификатор Wikidata
  - `wikipedia` - ссылка на Wikipedia
  - `tourism` - тип туристического объекта
  - `heritage` - объект наследия
  - `wheelchair` - доступность для инвалидных колясок

- `namedetails` - названия на разных языках:
  - Поддерживается множество языков (en, de, fr, ja, ko, zh и др.)
  - Альтернативные названия (alt_name)

- `boundingbox` - ограничивающий прямоугольник [min_lat, max_lat, min_lon, max_lon]

### Пример успешного ответа

Для запроса "Красная площадь, Москва" получен следующий результат:

```json
{
  "place_id": 185747538,
  "osm_type": "relation",
  "osm_id": 1577673,
  "lat": "55.7535908",
  "lon": "37.6215013",
  "class": "highway",
  "type": "pedestrian",
  "importance": 0.5841613501520024,
  "display_name": "Красная площадь, 4, Китай-город, Тверской район, Москва, Центральный федеральный округ, 109012, Россия"
}
```

### Анализ качества результатов

1. **Точность геокодирования:** API корректно определил Красную площадь в Москве
2. **Полнота данных:** Ответ содержит исчерпывающую информацию об объекте
3. **Многоязычность:** Поддерживаются названия на множестве языков
4. **Структурированность:** Адрес разбит на логические компоненты
5. **Дополнительные данные:** Включены ссылки на Wikipedia, Wikidata и другие источники

### Рекомендации по использованию

1. **Всегда указывайте User-Agent** для идентификации вашего приложения
2. **Используйте параметр limit** для ограничения количества результатов
3. **Включайте addressdetails=1** для получения структурированного адреса
4. **Используйте accept-language** для получения результатов на нужном языке
5. **Делайте паузы между запросами** для соблюдения политики использования
6. **Обрабатывайте ошибки** - API может возвращать различные коды состояния

