# Анализ Skyscanner Car Hire Autosuggest API

## Основная информация

**Endpoint:** POST https://partners.api.skyscanner.net/apiservices/v3/autosuggest/carhire

## Структура запроса

### Основные параметры
- `query` - объект, содержащий параметры для поиска автопредложений аренды автомобилей

### Поля объекта query
- `market` - рынок, откуда идет поиск (например, "UK")
- `locale` - язык для поиска (ISO locale, например, "en-GB")
- `searchTerm` - строка для получения автопредложений (например, "Pari"). Если оставить пустым, вернутся самые популярные места аренды автомобилей

## Структура ответа

API возвращает список `places` с объектами, содержащими следующие поля:

- `hierarchy` - иерархия мест, связанных с этой сущностью (например, City of Edinburgh)
- `location` - координаты сущности в формате "широта,долгота" (например, "55.9497, -3.3635")
- `name` - название места (например, "London")
- `highlight` - указывает на выделение символов, которые соответствуют searchTerm
- `entityId` - уникальный ID места (внутренний ID, не имеет значения вне API Skyscanner)
- `type` - тип места

## Типы мест (Entity Types)

Возможные значения для поля `type`:
- PLACE_TYPE_TRAIN_STATION
- PLACE_TYPE_DISTRICT  
- PLACE_TYPE_AIRPORT
- PLACE_TYPE_CITY



## Дополнительная информация из API Reference

### Полный список типов мест
- PLACE_TYPE_UNSPECIFIED
- PLACE_TYPE_TRAIN_STATION
- PLACE_TYPE_DISTRICT  
- PLACE_TYPE_AIRPORT
- PLACE_TYPE_CITY

### Дополнительные поля ответа
- `highlight` - объект (CarHireHighlight) для выделения совпадающих символов

### Требования к авторизации
- Требуется UserAuth (API ключ)

### Возможные коды ответов
- 200: Успешный ответ
- 400: Неверный запрос
- 401: Неавторизован. Необходим действительный API ключ
- 403: Нет доступа к запрашиваемому ресурсу
- 404: Ресурс не найден
- 429: Слишком много запросов (превышен лимит)
- 500: Внутренняя ошибка сервера
- 503: Сервис недоступен



## Тестирование API

### Созданные тестовые скрипты

1. **test_skyscanner_api.py** - основной скрипт для тестирования API
2. **simulate_api_response.py** - скрипт для симуляции ответов API

### Тестовые сценарии

Были подготовлены следующие тестовые случаи:

1. **Поиск по частичному названию города**
   - Запрос: "Lond" (для London)
   - Market: "UK", Locale: "en-GB"

2. **Поиск по частичному названию города (другой пример)**
   - Запрос: "Pari" (для Paris)
   - Market: "UK", Locale: "en-GB"

3. **Получение популярных мест**
   - Запрос: "" (пустой searchTerm)
   - Market: "UK", Locale: "en-GB"

4. **Поиск с русской локалью**
   - Запрос: "Моск" (для Москвы)
   - Market: "RU", Locale: "ru-RU"

### Симулированные результаты

#### Результат поиска "Lond"
Найдено 5 мест:
1. **London** (PLACE_TYPE_CITY)
   - Координаты: 51.5074, -0.1278
   - Иерархия: United Kingdom > England > London

2. **London Heathrow Airport** (PLACE_TYPE_AIRPORT)
   - Координаты: 51.4700, -0.4543
   - Иерархия: United Kingdom > England > London > London Heathrow Airport

3. **London Gatwick Airport** (PLACE_TYPE_AIRPORT)
   - Координаты: 51.1481, -0.1903
   - Иерархия: United Kingdom > England > London > London Gatwick Airport

4. **London Stansted Airport** (PLACE_TYPE_AIRPORT)
   - Координаты: 51.8860, 0.2389
   - Иерархия: United Kingdom > England > London > London Stansted Airport

5. **London Bridge** (PLACE_TYPE_DISTRICT)
   - Координаты: 51.5045, -0.0865
   - Иерархия: United Kingdom > England > London > London Bridge

#### Результат для популярных мест (пустой searchTerm)
Найдено 5 популярных мест:
1. London (PLACE_TYPE_CITY)
2. Manchester (PLACE_TYPE_CITY)
3. Birmingham (PLACE_TYPE_CITY)
4. Edinburgh (PLACE_TYPE_CITY)
5. Glasgow (PLACE_TYPE_CITY)

## Анализ результатов

### Функциональность выделения (Highlight)
API предоставляет функцию выделения совпадающих символов:
- Для поиска "Lond" выделяются символы 0-4 в названии "London"
- Это помогает пользователю понять, какая часть названия соответствует поисковому запросу

### Типы мест в ответах
Анализ показал следующее распределение типов:
- **PLACE_TYPE_CITY**: 6 мест (города)
- **PLACE_TYPE_AIRPORT**: 3 места (аэропорты)
- **PLACE_TYPE_DISTRICT**: 1 место (район)

### Иерархическая структура
API возвращает иерархическую структуру мест в формате:
`Страна > Регион > Город > Конкретное место`

Примеры:
- `United Kingdom > England > London`
- `United Kingdom > England > London > London Heathrow Airport`
- `United Kingdom > Scotland > Edinburgh`

### Координаты
Все места содержат точные GPS координаты в формате "широта,долгота", что позволяет:
- Отображать места на карте
- Вычислять расстояния
- Интегрироваться с картографическими сервисами

## Практические рекомендации

### Для разработчиков

1. **Авторизация**: Обязательно получите API ключ на https://developers.skyscanner.net/
2. **Обработка ошибок**: Предусмотрите обработку всех возможных HTTP кодов ответов
3. **Кэширование**: Рассмотрите кэширование популярных запросов для улучшения производительности
4. **Локализация**: Используйте соответствующие market и locale для целевой аудитории

### Для пользовательского интерфейса

1. **Автодополнение**: Используйте API для реализации автодополнения в поисковых полях
2. **Выделение**: Используйте данные highlight для визуального выделения совпадений
3. **Иерархия**: Отображайте иерархическую информацию для лучшего понимания местоположения
4. **Типы мест**: Используйте иконки или цветовое кодирование для разных типов мест

### Ограничения и особенности

1. **Rate Limiting**: API имеет ограничения на количество запросов
2. **Зависимость от рынка**: Результаты зависят от выбранного рынка (market)
3. **Внутренние ID**: entityId являются внутренними и могут изменяться
4. **Языковая поддержка**: Качество результатов зависит от поддерживаемых локалей

## Заключение

Skyscanner Car Hire Autosuggest API предоставляет мощный инструмент для реализации автопредложений при поиске мест аренды автомобилей. API хорошо документирован, имеет понятную структуру запросов и ответов, и предоставляет богатую информацию о местах, включая координаты, иерархию и функцию выделения совпадений.

Для успешной интеграции необходимо получить API ключ и правильно обрабатывать различные типы ответов и ошибок. API особенно полезен для создания интуитивных пользовательских интерфейсов с автодополнением и географической привязкой.

